{{this.filteredLetters}}
{{#if this.letters}}
  <section uk-grid class="uk-child-width-1-3 uk-form-stacked uk-margin-small">
    {{#if this.maxEndDate}}
      <section>
        <label class="uk-form-label">
          Start Date:
        </label>
        <section uk-form-custom target="true">
          <PikadayInput
            id="start-date-field"
            class="uk-input uk-form-width-medium"
            @minDate={{this.minStartDate}}
            @maxDate={{this.maxEndDate}}
            @value={{this.startDate}}
            @onSelection={{action "fetchRange" "min"}} />
        </section>
        <UkButton @color="primary" @size="small" @on-click={{action "resetStart"}}>Reset</UkButton>
      </section>
      <section>
        <label class="uk-form-label">
          End Date:
        </label>
        <section uk-form-custom target="true">
          <PikadayInput
            id="end-date-field"
            class="uk-input"
            @minDate={{letterDates.min}}
            @maxDate={{letterDates.max}}
            @value={{this.endDate}}
            @onSelection={{action "fetchRange" "max"}} />
        </section>
        <UkButton @color="primary" @size="small" @on-click={{action "resetEnd"}}>Reset</UkButton>
      </section>
    {{/if}}
    <section>
      <label class="uk-form-label">
        Recipient:
      </label>
      <section uk-grid class="uk-form-controls">
        {{!-- <button class="uk-form-icon uk-form-icon-flip" onclick={{action "clearRecipientsFilter"}} uk-icon="icon: close"></button> --}}
        <section class="uk-width-2-3">
          <input class="uk-input " id="autoComplete" tabindex="1" disabled={{this.autoCompleteEmpty}} placeholder={{if this.autoCompleteEmpty "Loading..."}} value={{this.recipients}}>
          <AutoComplete @filterRecipients={{action "filterRecipients"}} @enableAutoComplete={{action "enableAutoComplete"}}/>
        </section>
        <section class="uk-width-1-3 uk-padding-small uk-padding-remove-top uk-padding-remove-bottom">
          <UkButton @color="primary" @size="small" @on-click={{action "clearRecipientsFilter"}}>Clear</UkButton>
        </section>
      </section>
    </section>
  </section>

  <section class="uk-padding-top uk-padding uk-padding-remove-left uk-padding-remove-bottom">
    {{!-- {{input value=this.items type="number"}} --}}
    <ul class="uk-pagination" uk-margin>
      <li><UkButton @color="link" @on-click={{action "prevPageRequested"}}><span uk-pagination-previous></span></UkButton></li>
      <li><UkButton @color="link" @on-click={{action "jumpToPage" "1"}}>1</UkButton></li>
      <li class="uk-disabled"><span>...</span></li>
      <li class="uk-active"><span>{{currentPage}}</span></li>
      <li class="uk-disabled"><span>...</span></li>
      <li><UkButton @color="link" @on-click={{action "jumpToPage" this.lastPage}}>{{this.lastPage}}</UkButton></li>
      <li><UkButton  @color="link" @on-click={{action "nextPageRequested"}}><span uk-pagination-next></span></UkButton></li>
      <li class="uk-form-label">Per Page:</li>
      <li>
        <select class="uk-select" onchange={{action "setItems" value="target.value"}}>
          <option value={{this.items}} selected>
            {{this.items}}
          </option>
          {{#each itemValues as |n|}}
            <option value={{n}}>
              {{n}}
            </option>
          {{/each}}
        </select>
      </li>
      <li class="uk-for-label">Jump to Page:</li>
      <li>
        <select class="uk-select" onchange={{action "jumpToPage" value="target.value"}}>
          {{#each this.resultPages as |n|}}
            <option value={{n}} selected={{eq n this.currentPageInt}}>
              {{n}}
            </option>
          {{/each}}
        </select>
      </li>
      <li>
        <div class="uk-margin uk-grid-small uk-child-width-auto uk-grid">
          <label for="toggle-flagged" class="">
            Flagged
          </label>
          {{input class="uk-checkbox" type="checkbox" id="toggle-flagged" checked=this.flaggedOnly change=(action "toggleFlagged")}}
        </div>
      </li>
    </ul>
  </section>
  <section class="letter-list">
    {{#data-sorter data=byDate as |ds|}}
      {{#data-table data=ds.data classNames=tableClassNames onRowSingleClick=(action "onRowSingleClick")
              as |t|}}
        {{t.column propertyName="recipient_list" name="Recipient"}}
        {{!-- {{t.sortableColumn propertyName="legacy_pk" name="Legacy ID" sortinformationupdated=(action ds.onsortfieldupdated)}} --}}
        {{!-- {{t.sortableColumn propertyName="recipient_list" name="Recipients" sortinformationupdated=(action ds.onsortfieldupdated)}} --}}
        {{t.sortableColumn propertyName="formatted_date" name="Date Sent" sortinformationupdated=(action ds.onsortfieldupdated)}}
        {{t.column propertyName="entity-count" name="Tag Count"}}
      {{/data-table}}
    {{/data-sorter}}
    <ul class="uk-pagination" uk-margin>
      <li><UkButton @color="link" @on-click={{action "prevPageRequested"}}><span uk-pagination-previous></span></UkButton></li>
      <li><UkButton @color="link" @on-click={{action "jumpToPage" "1"}}>1</UkButton></li>
      <li class="uk-disabled"><span>...</span></li>
      <li class="uk-active"><span>{{currentPage}}</span></li>
      <li class="uk-disabled"><span>...</span></li>
      <li><UkButton @color="link" @on-click={{action "jumpToPage" this.lastPage}}>{{this.lastPage}}</UkButton></li>
      <li><UkButton  @color="link" @on-click={{action "nextPageRequested"}}><span uk-pagination-next></span></UkButton></li>
      <li class="uk-form-label">Per Page:</li>
      <li>
        <select class="uk-select" onchange={{action "setItems" value="target.value"}}>
          <option value={{this.items}} selected>
            {{this.items}}
          </option>
          {{#each itemValues as |n|}}
            <option value={{n}}>
              {{n}}
            </option>
          {{/each}}
        </select>
      </li>
      <li class="uk-for-label">Jump to Page:</li>
      <li>
        <select class="uk-select" onchange={{action "jumpToPage" value="target.value"}}>
          {{#each this.resultPages as |n|}}
            <option value={{n}} selected={{eq n this.currentPageInt}}>
              {{n}}
            </option>
          {{/each}}
        </select>
      </li>
    </ul>
  </section>
{{else}}
  <div class="task-running">
    <div class="uk-position-center uk-text-large">
      Loading Letters...
    </div>
  </div>
{{/if}}